{% extends 'layout_edit.html' %}
{% load i18n %}
{% load staticfiles %}
{% load url %}
{% block extra_css %}
    <link href="{% static 'css/bootstrap-datetimepicker.min.css' %}" rel="stylesheet">
{% endblock %}
{% block extra_js %}
    <script src="{% static 'js/bootstrap-datetimepicker.min.js' %}"></script>
{% endblock %}
{% block extra_scripts %}

{% endblock %}
{% block content %}
    <form class="form-horizontal" method="post" name="bills_form">{% csrf_token %}
        <div class="row">
            <div class="col-md-6">
                <div class="form-group form-group-sm">
                    <label for="inputEmail3" class="col-sm-4 control-label">{% trans 'Deposit:' %}</label>
                    <div class="col-sm-8">
                        {% if user.bill.deposit > 50 %}
                            <span class="label label-success form-control-static" >{{ user.bill.deposit|floatformat:4 }}</span>
                        {% elif user.bill.deposit < 50 and user.bill.deposit > 20 %}
                            <span class="label label-primary form-control-static" >{{ user.bill.deposit|floatformat:4 }}</span>
                        {% elif user.bill.deposit < 20 and user.bill.deposit > 2.50 %}
                            <span class="label label-warning form-control-static" >{{ user.bill.deposit|floatformat:4 }}</span>
                        {% else %}
                            <span class="label label-danger form-control-static" >{{ user.bill.deposit|floatformat:4 }}</span>
                        {% endif %}
                        <div class="pull-right">
                            <a href="{% url 'core:client_payments' uid %}" class="btn btn-default btn-xs"><i class="fa fa-plus-circle"></i></a>
                            <a href="{% url 'core:client_fees' uid %}" class="btn btn-default btn-xs"><i class="fa fa-minus-circle"></i></a>
                            <a class="btn btn-default btn-xs"><i class="fa fa-print"></i></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group form-group-sm">
                    <label for="inputPassword3" class="col-sm-4 control-label">{% trans 'Credit' %}</label>
                    <div class="col-sm-8">
                        <input type="number" class="form-control" id="credit" name="credit" placeholder="{% trans 'Credit' %}" value="{{ user.credit }}">
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group form-group-sm">
                    <label for="inputPassword3" class="col-sm-4 control-label">{% trans 'Company:' %}</label>
                    <div class="col-sm-8">
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="{% trans 'Company' %}" aria-describedby="group" disabled value="{{ user.company }}">
                            <span class="input-group-addon" id="group">
                                <a href="{% url 'core:user_company' uid %}">
                                    {% if user.company != 0 %}
                                        <i class="fa fa-edit fa-fw"></i>
                                    {% else %}
                                        <i class="fa fa-plus fa-fw"></i>
                                    {% endif %}
                                </a>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group form-group-sm">
                    <label for="inputPassword3" class="col-sm-4 control-label">{% trans 'Credit date' %}</label>
                    <div class="col-sm-8">
                        <div id="credit_date-datepicker" class="">
                            <div class="input-group">
                                <input data-format="yyyy-MM-dd" type="date" class="form-control" id="credit_date" aria-describedby="credit-date" name="credit_date" placeholder="{% trans 'Credit date' %}" value="{{ user.credit_date|default:"0000-00-00" }}">
                                <span class="input-group-addon add-on" id="credit-date">
                                    <i class="fa fa-calendar" data-time-icon="icon-time" data-date-icon="fa-calendar"></i>
                                </span>
                            </div>
                        </div>
                        <script type="text/javascript">
                            $(function() {
                                $('#credit_date-datepicker').datetimepicker({
                                    pickTime: false
                                });
                            });
                        </script>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group form-group-sm">
                    <label for="inputEmail3" class="col-sm-4 control-label">{% trans 'Group' %}</label>
                    <div class="col-sm-8">
                        <div class="input-group">
                          <input type="text" class="form-control" placeholder="{% trans 'Group' %}" aria-describedby="group" disabled value="{{ user.gid }}">
                          <span class="input-group-addon" id="group">
                              <a href="{% url 'core:user_group' user.id %}">
                                  <i class="fa fa-edit fa-fw"></i>
                              </a>
                          </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group form-group-sm">
                    <label for="inputEmail3" class="col-sm-4 control-label">{% trans 'Cash account' %}</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="" placeholder="{% trans 'Cash account' %}" disabled value="{{ bill.id }}">
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group form-group-sm">
                    <label for="inputPassword3" class="col-sm-4 control-label">{% trans 'Reduction' %}</label>
                    <div class="col-sm-8">
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="{% trans 'Reduction' %}" aria-describedby="group" value="{{ user.reduction }}">
                            <span class="input-group-addon" id="reduction"><i class="fa fa-percent fa-fw"></i></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group form-group-sm">
                    <label for="" class="col-sm-4 control-label">{% trans 'Reduction date' %}</label>
                    <div class="col-sm-8">
                        <div id="reduction_date-datepicker" class="">
                            <div class="input-group">
                                <input data-format="yyyy-MM-dd" type="date" class="form-control" id="reduction_date" aria-describedby="reduction-date" name="reduction_date" placeholder="{% trans 'Reduction date' %}" value="{{ user.reduction_date|default:"0000-00-00" }}">
                                <span class="input-group-addon add-on" id="reduction-date">
                                    <i class="fa fa-calendar" data-time-icon="icon-time" data-date-icon="fa-calendar"></i>
                                </span>
                            </div>
                        </div>
                        <script type="text/javascript">
                            $(function() {
                                $('#reduction_date-datepicker').datetimepicker({
                                    pickTime: false
                                });
                            });
                        </script>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group form-group-sm">
                    <label for="inputPassword3" class="col-sm-4 control-label">{% trans 'Disable' %}</label>
                    <div class="col-sm-8">
                        {% if user.disabled == True %}
                            <input id="disable" type="checkbox" name="disable" value="1" checked onclick="changeValueCheckbox(this)">
                        {% else %}
                            <input id="disable" type="checkbox" name="disable" onclick="changeValueCheckbox(this)">
                        {% endif %}
                        <input type="text" class="form-control hidden" id="reason" name="reason">
                        <script type="application/javascript">
                            function changeValueCheckbox(element){
                                if(element.checked){
                                    element.value='1';
                                }else{
                                    element.value='0';
                                }
                                if (element.value == 1){
                                    var reason = prompt('{% trans 'Reason' %}')
                                    if (reason != null){
                                        $('#reason').removeClass('hidden');
                                        $('#reason').val(reason);
                                    } else {
                                        element.value = '0';
                                        $(element).removeAttr('checked')
                                    }
                                } else {
                                    $('#reason').addClass('hidden');
                                    element.value = '0';
                                }
                            }
                        </script>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group form-group-sm">
                    <label for="" class="col-sm-4 control-label">{% trans 'Activation' %}</label>
                    <div class="col-sm-8">
                        <div id="activation-datepicker" class="">
                            <div class="input-group">
                                <input data-format="yyyy-MM-dd" type="date" class="form-control" id="activation" aria-describedby="activation-date" name="activation" placeholder="{% trans 'Activation' %}" value="{{ user.activate|default:"0000-00-00" }}">
                                <span class="input-group-addon add-on" id="activation-date">
                                    <i class="fa fa-calendar" data-time-icon="icon-time" data-date-icon="fa-calendar"></i>
                                </span>
                            </div>
                        </div>
                        <script type="text/javascript">
                            $(function() {
                                $('#activation-datepicker').datetimepicker({
                                    pickTime: false
                                });
                            });
                        </script>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group form-group-sm">
                    <label for="registration" class="col-sm-4 control-label">{% trans 'Registration' %}</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="registration" name="registration" placeholder="" disabled value="{{ bill.registration }}">
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group form-group-sm">
                    <label for="" class="col-sm-4 control-label">{% trans 'Expire' %}</label>
                    <div class="col-sm-8">
                        <div id="expire-datepicker" class="">
                            <div class="input-group">
                                <input data-format="yyyy-MM-dd" type="text" class="form-control" id="expire" name="expire" placeholder="{% trans 'Expire' %}" value="{{ user.expire|default:"0000-00-00" }}">
                                <span class="input-group-addon add-on" id="expire-date">
                                    <i class="fa fa-calendar" data-time-icon="icon-time" data-date-icon="fa-calendar"></i>
                                </span>
                            </div>
                        </div>
                        <script type="text/javascript">
                            $(function() {
                                $('#expire-datepicker').datetimepicker({
                                    useCurrent: false,
                                    pickTime: false
                                });
                            });
                        </script>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="span7 text-center">
                    {% if user_password %}
                        <span class="label label-success">{{ user_password }}</span>
                    {% else %}
                        <a class="btn btn-default btn-xs" href="{% url 'core:client' uid %}?show_password=1" role="button">{% trans 'Show password' %}</a>
                    {% endif %}
                    <button type="button" class="btn btn-default btn-xs">{% trans 'Change password' %}</button>
                    <button type="button" class="btn btn-default btn-xs">{% trans 'Send password SMS' %}</button>
                    {% if user_olltv %}
                        <a class="btn btn-primary btn-xs" href="{% url 'olltv:user_change' uid %}" role="button">{% trans 'Olltv' %}</a>
                    {% else %}
                    {% endif %}
                </div>
            </div>
        </div>
        <hr/>
        <input type="submit" class="btn btn-primary btn-xs center-block" value="{% trans 'Change' %}">
        <hr/>
        <div class="row">
            <div class="col-md-2"></div>
            <div class="col-md-6 center-col text-center">
                <table class="table table-bordered table-striped table-hover table-condensed">
                    <thead class="">
                        <tr class="border-color">
                            <th class="text-center">IP</th>
                            <th class="text-center">Session time</th>
                            <th class="text-center">Trafic in</th>
                            <th class="text-center">Trafic out</th>
                            <th class="text-center">Server</th>
                            <th class="text-center">Zap</th>
                            <th class="text-center">Hangup</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for s in dv_session %}
                            <tr>
                                <td>
                                    {% ip_convert s.framed_ip_address %}
                                </td>
                                <td>
                                    {% convert_timestamp_to_time s.started %}
                                </td>
                                <td>
                                    {% convert_bytes  s.acct_input_octets s.acct_input_gigawords%}
                                </td>
                                <td>
                                    {% convert_bytes s.acct_output_octets s.acct_output_gigawords%}
                                </td>
                                <td>
                                    {{ s.nas }}
                                </td>
                                <td>
                                    <button type="button" class="btn btn-xs btn-link"><span style="margin-right: 5px" class="glyphicon glyphicon-remove"></span></button>
                                </td>
                                <td>
                                    <button type="button" class="btn btn-xs btn-link"><span style="margin-right: 5px" class="glyphicon glyphicon-off"></span></button>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="col-md-2"></div>
        </div>
    </form>
{% endblock %}
{% block extra_content %}
    <div class="well well-sm">
        {% include 'dv.html' with dv=dv %}
    </div>
    <div class="well well-sm">
        <div class="page-header text-center">
            <h4>{% trans 'User info' %}</h4>
        </div>
        <form class="form-horizontal" method="post" name="user_form">{% csrf_token %}
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group form-group-sm">
                        <label for="inputEmail3" class="col-sm-4 control-label">{% trans 'FIO:' %}</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="firstname" name="firstname" placeholder="Firstname, Lastname" value="{{ user.pi.fio }}">
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group form-group-sm">
                        <label for="inputEmail3" class="col-sm-4 control-label">{% trans 'Districts:' %}</label>
                        <div class="col-sm-8">
                            <select class="form-control" id="district">
                                {% for item in district %}
                                    <option value="{{ item.id }}">{{ item }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group form-group-sm">
                        <label for="inputEmail3" class="col-sm-4 control-label">E-mail:</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="e-mail" name="e-mail" placeholder="E-mail:" value="{{ user.pi.email }}">
                        </div>
                    </div>
                </div>
                <hr>
                <div class="col-md-6">
                    <div class="form-group form-group-sm">
                        <label for="inputEmail3" class="col-sm-4 control-label">{% trans 'Street:' %}</label>
                        <div class="col-sm-8">
                            <select class="form-control" id="location" name="location">
                            <option value="{{ user.pi.street_id }}">{{ user.pi.street }}</option>
                                {% for item in streets %}
                                    <option value="{{ item.id }}">{{ item }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group form-group-sm">
                        <label for="inputEmail3" class="col-sm-4 control-label">{% trans 'Phone:' %}</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="phone" name="phone" placeholder="{% trans 'phone' %}" value="{{ user.pi.phone }}">
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group form-group-sm">
                        <label for="inputEmail3" class="col-sm-4 control-label">{% trans 'Build:' %}</label>
                        <div class="col-sm-8">
                            <select class="form-control" name="build">
                                {% for item in houses %}
                                    <option value="{{ item.id }}">{{ item }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                </div>
                <div class="col-md-6">
                        <div class="form-group form-group-sm">
                            <label for="inputEmail3" class="col-sm-4 control-label">Flat:</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" id="flat" name="flat" placeholder="Flat:" value="{{ user.pi.kv }}">
                            </div>
                        </div>
                    </div>
                </div>
            <hr/>
            <input type="submit" name="dv_submit" class="btn btn-primary btn-xs center-block" value="{% trans 'Change' %}">
        </form>
    </div>
{% endblock %}